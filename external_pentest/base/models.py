from django.db import models

class Scan(models.Model):
	user = models.ForeignKey('auth.User', on_delete=models.CASCADE)
	name = models.CharField(max_length=100, default="unnamed")
	main_domain = models.CharField(max_length=100)
	done = models.IntegerField(default=0)


class IP(models.Model):
	ip = models.GenericIPAddressField(protocol='IPv4')
	t = models.CharField(max_length=2, blank=True, null=True)
	ip_domain = models.ForeignKey('Domain', on_delete=models.CASCADE, blank=True, null=True)
	state = models.CharField(max_length=4, blank=True, null=True)
	scan = models.ForeignKey('Scan', on_delete=models.CASCADE)

class Domain(models.Model):
	domain = models.CharField(max_length=100)
	t = models.CharField(max_length=4, default='SUB')
	scan = models.ForeignKey('Scan', on_delete=models.CASCADE)

class Port(models.Model):
	scan = models.ForeignKey('Scan', on_delete=models.CASCADE, null=True, default=None)
	ip = models.ForeignKey('IP', on_delete=models.CASCADE)
	port = models.IntegerField()
	name = models.CharField(max_length=100, blank=True)
	product = models.CharField(max_length=100, blank=True)
	version = models.CharField(max_length=100, blank=True)
	protocol = models.CharField(max_length=100, blank=True)

class MailReport(models.Model):
	scan = models.ForeignKey('Scan', on_delete=models.CASCADE)
	mail_domain = models.ForeignKey('Domain', on_delete=models.CASCADE)
	report = models.TextField()

